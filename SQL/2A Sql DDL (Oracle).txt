-- DBMS Assignment 2A (Oracle Version)
-- RESET OLD OBJECTS
BEGIN
  EXECUTE IMMEDIATE 'DROP VIEW emp_view';
EXCEPTION
  WHEN OTHERS THEN NULL;
END;
/

BEGIN
  EXECUTE IMMEDIATE 'DROP TABLE Employee';
EXCEPTION
  WHEN OTHERS THEN NULL;
END;
/

-- 1) CREATE TABLE WITH CONSTRAINTS
CREATE TABLE Employee (
  emp_id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  name VARCHAR2(30) NOT NULL,
  dept VARCHAR2(20),
  salary NUMBER CHECK (salary > 0),
  email VARCHAR2(50) UNIQUE
);

-- 2) CREATE INDEX
CREATE INDEX idx_emp_dept ON Employee(dept);

-- 3) INSERT RECORDS
INSERT INTO Employee (name, dept, salary, email) VALUES ('Rohit', 'IT', 35000, 'rohit@mail.com');
INSERT INTO Employee (name, dept, salary, email) VALUES ('Sneha', 'HR', 42000, 'sneha@mail.com');
INSERT INTO Employee (name, dept, salary, email) VALUES ('Amit', 'IT', 38000, 'amit@mail.com');

-- 4) CREATE VIEW
CREATE OR REPLACE VIEW emp_view AS
SELECT emp_id, name, dept, salary
FROM Employee;

-- 5) SELECT WITH WHERE
SELECT * FROM emp_view
WHERE salary > 35000;

-- 6) SELECT USING UPPER / LOWER
SELECT UPPER(name) AS NAME_UPPER,
       LOWER(dept) AS DEPT_LOWER
FROM Employee;

-- 7) UPDATE
UPDATE Employee
SET salary = salary + 2000
WHERE dept = 'IT';

-- 8) DELETE
DELETE FROM Employee
WHERE salary < 36000;

-- 9) UNION
SELECT name FROM Employee WHERE dept = 'IT'
UNION
SELECT name FROM Employee WHERE dept = 'HR';

-- 10) MINUS (Oracle supports MINUS)
SELECT name FROM Employee WHERE dept = 'HR'
MINUS
SELECT name FROM Employee WHERE dept = 'IT';

-- FINAL OUTPUTS
SELECT * FROM Employee;
SELECT * FROM emp_view;
